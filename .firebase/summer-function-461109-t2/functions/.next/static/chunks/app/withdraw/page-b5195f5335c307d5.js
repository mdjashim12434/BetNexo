(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5621],{707:(e,t,s)=>{"use strict";s.d(t,{default:()=>u});var a=s(5155),n=s(6874),r=s.n(n),i=s(285),o=s(283),c=s(5695),l=s(4301),d=s(5074);function m(){let{user:e,balance:t,currency:s,logout:n,loadingAuth:m}=(0,o.A)();return(0,c.useRouter)(),(0,a.jsx)("header",{className:"sticky top-0 z-50 w-full border-b border-border/40 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,a.jsxs)("div",{className:"container flex h-16 items-center justify-between gap-4",children:[(0,a.jsx)("div",{className:"flex items-center",children:m?(0,a.jsx)("div",{className:"h-9 w-24 animate-pulse rounded-md bg-muted"}):e&&"Admin"!==e.role?(0,a.jsx)(i.$,{variant:"ghost",size:"sm",asChild:!0,children:(0,a.jsxs)(r(),{href:"/wallet",className:"flex items-center gap-2",children:[(0,a.jsx)(l.A,{className:"h-5 w-5 text-primary"}),(0,a.jsxs)("div",{className:"flex flex-col items-start",children:[(0,a.jsx)("span",{className:"text-xs font-semibold text-foreground",children:t.toFixed(2)}),(0,a.jsx)("span",{className:"text-[10px] text-muted-foreground -mt-1",children:s})]})]})}):(e&&e.role,(0,a.jsx)("div",{className:"w-24"}))}),(0,a.jsx)("div",{className:"flex-grow text-center",children:(0,a.jsxs)(r(),{href:"/",className:"text-4xl font-headline font-black italic tracking-tighter",children:[(0,a.jsx)("span",{className:"text-white",children:"Bet"}),(0,a.jsx)("span",{className:"text-primary",children:"Nexo"})]})}),(0,a.jsx)("div",{className:"flex items-center justify-end",children:e?(0,a.jsx)(i.$,{variant:"ghost",size:"icon",children:(0,a.jsx)(d.A,{className:"h-6 w-6 text-muted-foreground"})}):(0,a.jsx)("div",{className:"w-10"})})]})})}function u(e){let{children:t}=e;return(0,a.jsxs)("div",{className:"flex min-h-screen flex-col",children:[(0,a.jsx)(m,{}),(0,a.jsx)("main",{className:"flex-grow",children:t})]})}},851:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>f});var a=s(5155),n=s(707),r=s(4864),i=s(283),o=s(5695),c=s(2115),l=s(2523),d=s(285),m=s(6695),u=s(7481),x=s(2543),h=s(6104),p=s(8856);function f(){let{user:e,balance:t,currency:s,loadingAuth:f}=(0,i.A)(),g=(0,o.useRouter)(),{toast:A}=(0,u.dj)(),[y,v]=(0,c.useState)([]),[N,b]=(0,c.useState)(!0),[j,w]=(0,c.useState)(null),[T,k]=(0,c.useState)(""),[S,E]=(0,c.useState)(""),[M,C]=(0,c.useState)(!1),q=(0,c.useCallback)(async()=>{b(!0);try{let e=(0,h.P)((0,h.rJ)(h.db,"paymentMethods"),(0,h._M)("transactionType","==","withdrawal"),(0,h._M)("enabled","==",!0)),t=await (0,h.GG)(e),a=[];t.forEach(e=>{let t=e.data();a.push({id:e.id,name:t.name,logoUrl:t.logoUrl||"https://placehold.co/100x100.png?text=".concat(t.name.charAt(0)),description:"Min: ".concat(t.minAmount," ").concat(s,", Max: ").concat(t.maxAmount>0?t.maxAmount+" "+s:"No Limit"),type:"personal"===t.companyAccountType||"agent"===t.companyAccountType||"merchant"===t.companyAccountType?"mobile":"bank",dataAiHint:"".concat(t.name," logo"),companyAccountNumber:t.companyAccountNumber,companyAccountType:t.companyAccountType,minAmount:t.minAmount,maxAmount:t.maxAmount})}),v(a)}catch(t){console.error("Error fetching withdrawal methods:",t);let e="Could not load withdrawal methods.";t.message?t.message.toLowerCase().includes("missing or insufficient permissions")?e='Firestore reported: "'.concat(t.message,'" (Code: ').concat(t.code||"N/A","). This strongly indicates your Firestore security rules are not allowing this query for the currently authenticated user. Please double-check the rules for the 'paymentMethods' collection in your Firebase console. Ensure authenticated users have 'read' (list/get) permission for this collection, especially considering the query filters on 'transactionType' and 'enabled'."):t.message.toLowerCase().includes("index")||t.code&&t.code.toLowerCase().includes("failed-precondition")?e='Firestore reported: "'.concat(t.message,'" (Code: ').concat(t.code||"N/A","). This means a composite index is likely required for your query on the 'paymentMethods' collection (fields: 'transactionType' and 'enabled'). Please open your browser's developer console, find this exact Firebase error message, and click the link it provides to create the index in your Firebase console."):e+=" Details: ".concat(t.message," (Code: ").concat(t.code||"N/A",")"):e+=" An unknown error occurred. (Code: ".concat(t.code||"N/A",")"),A({title:"Error Loading Methods",description:e,variant:"destructive",duration:2e4})}finally{b(!1)}},[A,s]);(0,c.useEffect)(()=>{f||e||g.push("/login"),e&&q()},[e,f,g,q]);let _=async a=>{if(a.preventDefault(),!e||!e.customUserId||!j)return void A({title:"Error",description:"User or payment method not selected.",variant:"destructive"});let n=parseFloat(T);if(isNaN(n)||n<=0)return void A({title:"Invalid Amount",description:"Please enter a valid positive amount.",variant:"destructive"});if(n>t)return void A({title:"Insufficient Balance",description:"You do not have enough funds to request a withdrawal of ".concat(s," ").concat(n.toFixed(2),". Current balance: ").concat(s," ").concat(t.toFixed(2)),variant:"destructive"});if(j.minAmount>0&&n<j.minAmount)return void A({title:"Amount Too Low",description:"Minimum withdrawal amount is ".concat(j.minAmount," ").concat(s,"."),variant:"destructive"});if(j.maxAmount>0&&n>j.maxAmount)return void A({title:"Amount Too High",description:"Maximum withdrawal amount is ".concat(j.maxAmount," ").concat(s,"."),variant:"destructive"});if(!S.trim())return void A({title:"Account Details Required",description:"Please enter your account details for withdrawal.",variant:"destructive"});C(!0);try{let t={userId:e.customUserId,userName:e.name||e.email||"N/A",amount:n,currency:s,method:j.name,methodId:j.id,type:"withdrawal",status:"pending",userReceivingAccountDetails:S,platformSendingAccountNumber:j.companyAccountNumber,platformAccountType:j.companyAccountType,requestedAt:(0,h.O5)()};await (0,h.gS)((0,h.rJ)(h.db,"transactions"),t),A({title:"Withdrawal Request Submitted",description:"".concat(s," ").concat(n.toFixed(2)," withdrawal request to ").concat(S," is pending approval.")}),w(null),k(""),E("")}catch(e){console.error("Error submitting withdrawal request:",e),A({title:"Request Failed",description:"Could not submit your withdrawal request. "+e.message,variant:"destructive"})}finally{C(!1)}};if(f||e&&N)return(0,a.jsx)(n.default,{children:(0,a.jsx)("div",{className:"container py-6",children:(0,a.jsxs)("div",{className:"max-w-2xl mx-auto space-y-4",children:[(0,a.jsx)(p.E,{className:"h-10 w-1/2 mx-auto"}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3].map(e=>(0,a.jsx)(p.E,{className:"h-32 w-full"},e))})]})})});if(!e)return(0,a.jsx)(n.default,{children:(0,a.jsx)("div",{className:"text-center p-10",children:"Redirecting to login..."})});let I=parseFloat(T)||0;return(0,a.jsx)(n.default,{children:(0,a.jsx)("div",{className:"container py-6",children:(0,a.jsx)("div",{className:"max-w-2xl mx-auto",children:j?(0,a.jsxs)(m.Zp,{className:"shadow-xl",children:[(0,a.jsx)(m.aR,{children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(d.$,{variant:"ghost",size:"sm",onClick:()=>w(null),className:"text-sm",children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"})," Back"]}),(0,a.jsxs)(m.ZB,{className:"font-headline text-xl text-center flex-grow",children:["Withdraw via ",j.name]})]})}),(0,a.jsxs)(m.Wu,{className:"space-y-6",children:[(0,a.jsxs)(m.Zp,{className:"bg-muted/50 p-4",children:[(0,a.jsxs)(m.BT,{className:"text-sm text-foreground mb-2",children:["You are requesting withdrawal via ",(0,a.jsx)("strong",{children:j.name}),"."]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Platform Account: ",j.companyAccountNumber," (",j.companyAccountType,")"]}),j.minAmount>0&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Min Amount: ",j.minAmount," ",s]}),j.maxAmount>0&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Max Amount: ",j.maxAmount," ",s]})]})]}),(0,a.jsxs)("form",{onSubmit:_,className:"space-y-4",children:[(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Available Balance: ",(0,a.jsxs)("span",{className:"font-semibold text-foreground",children:[s," ",t.toFixed(2)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"amount",className:"block text-sm font-medium text-foreground mb-1",children:["Amount to Withdraw (",s,")"]}),(0,a.jsx)(l.p,{id:"amount",type:"number",value:T,onChange:e=>k(e.target.value),placeholder:"Enter amount (Min: ".concat(j.minAmount,", Max: ").concat(j.maxAmount>0?j.maxAmount:"N/A",")"),min:j.minAmount>0?j.minAmount.toString():"0.01",max:j.maxAmount>0?j.maxAmount.toString():void 0,step:"0.01",required:!0,className:"text-lg",disabled:M})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"userReceivingAccountDetails",className:"block text-sm font-medium text-foreground mb-1",children:"Your Receiving Account Details (e.g., Bkash/Nagad Number, Bank A/C)"}),(0,a.jsx)(l.p,{id:"userReceivingAccountDetails",type:"text",value:S,onChange:e=>E(e.target.value),placeholder:"Enter your account details for receiving funds",required:!0,className:"text-lg",disabled:M})]}),(0,a.jsx)(d.$,{type:"submit",className:"w-full font-semibold text-lg py-3",disabled:M||I<=0||I>t||j.minAmount>0&&I<j.minAmount||j.maxAmount>0&&I>j.maxAmount,children:M?"Submitting Request...":"Submit Withdrawal Request"}),I>0&&(I>t&&(0,a.jsx)("p",{className:"text-xs text-destructive text-center",children:"Withdrawal amount exceeds your available balance."})||j.minAmount>0&&I<j.minAmount&&(0,a.jsx)("p",{className:"text-xs text-destructive text-center",children:"Amount is less than minimum."})||j.maxAmount>0&&I>j.maxAmount&&(0,a.jsx)("p",{className:"text-xs text-destructive text-center",children:"Amount is more than maximum."}))]}),(0,a.jsx)("p",{className:"mt-4 text-xs text-muted-foreground text-center",children:"Withdrawals are typically processed within 24 hours after admin approval. Ensure your account details are correct."})]})]}):y.length>0?(0,a.jsx)(r.A,{methods:y,onSelectMethod:e=>{let t=y.find(t=>t.id===e);t&&(w(t),k(""),E(""))},actionType:"Withdraw"}):(0,a.jsx)("p",{className:"text-center text-muted-foreground py-10",children:"No withdrawal methods are currently available. Please check back later."})})})})}},2523:(e,t,s)=>{"use strict";s.d(t,{p:()=>i});var a=s(5155),n=s(2115),r=s(9434);let i=n.forwardRef((e,t)=>{let{className:s,type:n,...i}=e;return(0,a.jsx)("input",{type:n,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...i})});i.displayName="Input"},2543:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4301:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},4864:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});var a=s(5155),n=s(6695),r=s(285),i=s(6766);let o=e=>{let{methods:t,onSelectMethod:s,actionType:o}=e;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("h2",{className:"font-headline text-2xl font-semibold text-center",children:["Choose a ",o," Method"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(e=>(0,a.jsxs)(n.Zp,{className:"hover:shadow-primary/30 hover:shadow-lg transition-all duration-300 cursor-pointer transform hover:-translate-y-1",onClick:()=>s(e.id),children:[(0,a.jsxs)(n.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsx)(n.ZB,{className:"text-lg font-medium",children:e.name}),(0,a.jsx)(i.default,{src:e.logoUrl,alt:"".concat(e.name," logo"),width:40,height:40,className:"rounded","data-ai-hint":e.dataAiHint||"".concat(e.name," logo")})]}),(0,a.jsxs)(n.Wu,{children:[e.description&&(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:e.description}),(0,a.jsxs)(r.$,{className:"w-full bg-primary hover:bg-primary/90",children:[o," with ",e.name]})]})]},e.id))}),0===t.length&&(0,a.jsxs)("p",{className:"text-center text-muted-foreground",children:["No ",o.toLowerCase()," methods available at the moment."]})]})}},5074:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},7481:(e,t,s)=>{"use strict";s.d(t,{dj:()=>u});var a=s(2115);let n=0,r=new Map,i=e=>{if(r.has(e))return;let t=setTimeout(()=>{r.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);r.set(e,t)},o=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?i(s):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},c=[],l={toasts:[]};function d(e){l=o(l,e),c.forEach(e=>{e(l)})}function m(e){let{...t}=e,s=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>d({type:"DISMISS_TOAST",toastId:s});return d({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function u(){let[e,t]=a.useState(l);return a.useEffect(()=>(c.push(t),()=>{let e=c.indexOf(t);e>-1&&c.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},8802:(e,t,s)=>{Promise.resolve().then(s.bind(s,851))},8856:(e,t,s)=>{"use strict";s.d(t,{E:()=>r});var a=s(5155),n=s(9434);function r(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)("animate-pulse rounded-md bg-muted",t),...s})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,3644,3139,6874,6766,53,8441,1684,7358],()=>t(8802)),_N_E=e.O()}]);